---
layout: post
title: vim的一些技巧
date: 2017-11-12
description: “vim的一些技巧，提升工作效率”
tag: technology
---   


之前使用vim只会用简单的操作，遇到某些需求还是需要很麻烦的操作。
后来发现需要的功能其实vim都有，只是某些技巧还没掌握。
在此对vim功能做个简单汇总，以便日后查阅。


## 查找命令

>\*/#/gd 这两个可以查找完全匹配当前单词的字符串，*是往后找，#是往前找，gd会跳到文档第一个匹配处。

>g\*/g# 这两个命令可以查找包含当前单词的字符串，比如在单词is上，可以找到aisb，只使用*/#则不行

>% 跳到匹配的括号处(){}[]

>fx/Fx 跳到当前行前一个/后一个字符x处，x可以是任意字符。找到后输入;继续找，输入,反方向找。本身是查找命令，但用来移动光标非常方便

- - -

## 移动光标命令

>j/k/l/s   光标向上/下/左/右移动

>w(e)/b   下一个单词(词尾)/下一个单词

>0/^/$   行开头处/行开头第一个字符处/行末尾

>H/M/L   移动光标到：屏幕首行/屏中间一行/尾行，不难记，就是high/middle/low

>gg/G    整个文档的首行/尾行

>c-f/c-b   即page down/page up（c-表示连同ctrl键）

>c-u/c-d   屏幕向后/前移动半页，相当于半个page up/page down，u和d分别对应up和down

>c+e/c+y   编辑窗口中的文件内容整体上移/下移/下移一行

>\’\’   连按两个单引号，可以回到光标刚才的标记处，比如gd到文档开头，可以用’’回到刚才的地方

>\‘.   回到刚才修改的那一行

>`.    回到刚才修改的那个地方

>ma	把当前位置存成标签a

>`a	跳转到标签a处

>{/} 转到上一个/下一个空行

***

## 拷贝/删除/粘贴 命令

vim中y表示拷贝,d表示删除,p表示粘贴，后面跟内容表示具体的操作域，前面加数字表示执行次数。


>yw/ye/y0/y^/y$/yy   拷贝从当前光标到单词结尾/单词结尾/行首／行首第一个字符/行尾/整行

>dw/de/d0/d^/d$/dd   删除从当前光标到单词结尾/单词结尾/行首／行首第一个字符/行尾/整行

>yfx/dfx 或(yFx/dFx)   拷贝/删除当前光标到后面(或前面)第一个字符x处，x可以为任意字符

>y\*/y# 或(d\*/d#)   拷贝（或删除）当前光标到下一个/上一个光标所在单词处

>D   删除到行尾

>Y   拷贝整行

>]p   有缩进的粘贴，粘贴时会自动缩进

***

## 替换命令

vi/vim 中可以使用:s命令来替换字符串。方法为:

>[a,b]s/str1/str2/[g] 

其中[a,b]代表作用的行数，其中a、b为具体数字代表行数，为.代表当前行，为$代表最后一行。如果所有行，也可以用%替代。
g表示替换当前行的所有str1，不带g则仅替换当前行的第一个。

>s/str1/str2/   替换当前行第一个str1为str2

>s/str1/str2/g   替换当前行所有str1为str2

>10,$s/str1/str2/   替换第10行到最后一行中每一行的第一个str1为str2

>.,100s/str1/str2/g   替换当前行到第100行中每行的所有str1为str2

>%s/str1/str2/   其中%表示替换所有行

>%s/^/str1/   将所有行到开头处加入str1字符


除了用s命令开头，也可以用如下方式：

>g/str1/s//str2/   等同于 %s/str1/str2/ 替换每一行的第一个str1为str2

>g/str1/s//str2/g   等同于 %s/str1/str2/g 替换每一行中所有str1为str2

>g/str1/d   将所有包含str1的行删除

>g/^$/d   将所有空行删除

>%s/ *$//g   删除所有行尾空格

>s/str1/str2/gc   替换当前行所有str1为str2，替换的每次需要确认。c是confirm的缩写


可以使用 # 作为分隔符，此时中间出现的 / 不会作为分隔符 

>s#str1/#str2/#   替换当前行第一个 str1/ 为 str2/，使用了#作为分隔符

>s+/root/user1+/usr/user2+   替换 /root/user1 为/usr/user2，使用了+作为分隔符


#### 删除文本中的^M 

问题描述：对于换行，window下用回车换行（0A0D）来表示，linux下是回车（0A）来表示。
这样，将window上的文件拷到unix上用时，总会有个^M。
在unix下如何过滤windows文件的换行符（0D）？ 

使用命令：

>cat filename1 \| tr -d “^V^M” > newfile

或者
　 
>sed -e “s/^V^M//” filename > new file

注意^V和^M指的是Ctrl+V和Ctrl+M，你必须要手工进行输入，而不是粘贴上面命令。

如果在vim中，则可以使用：
　 
>%s/^V^M//

或者

>%s/^M$//g


如果上述方法无用，则正确的解决办法是:

>tr -d \"\\r\" < src >dest 

>tr -d \"\\015\" dest 

>strings A>B

***

##   大小写转换

>~  光标所在处的字符进行大小写互换

>guu/guw/gu$/gu0/gu^ 或者(gUU/gUw/gU$/gU0/gU^)   当前行/到词尾/到行尾/到行首/到行首第一个字符转换为小写(或大写)

***

## 其他

>\>\>   行向右移动一个tab

>:12,24>   将12行到14行的数据都向右移动一个tab.

>:12,24\>\>   将12行到14行的数据都向右移动两个tab.

>==  自动缩进当前行

>:newtab filename   新vim标签页打开文件

打开后：

>gt/gT  切换到下一个/上一个标签页

>c-ws   水平切分标签页，两个是同一个文件，有任何操作都是相同的

>c-wv   垂直切分标签页 

>c-ww   切换标签页

>c-wq   关闭当前标签页 

>:sp filename   split标签页打开文件

>:vsp filename   垂直split标签页打开文件

>:e filename   把当前缓冲区文件存为文件filename

>gg=G   自动缩进

>A   在本行行尾插入，相当于$a/$i

>J  可以去除本行和下一行之间的换行符，也就是将下一行续接到本行尾部，这个不要太有用

>cc   删除当前行并进入编辑模式

>cw   删除当前字，并进入编辑模式

>c$   删除至行末，并进入编辑模式

>s   删除当前字符并进入编辑模式

>S   删除光标所在行并进入编辑模式

>zz   将当前行放置于页面中间，利于阅读

>ga   显示光标字符的编码值
 
在执行拷贝/删除／跳转/转换大小写操作时，w代表光标处到当前词尾，aw表示不管光标位置总是整个词

>zt   将当前行放置于页面的最顶端，一般阅读函数定义时，非常非常有用

>c-a/c-x   可以将光标所在处的数字加1/减1

>/str1   向后查找str1

>?str1   向前查找str1


***

## 补齐

>c-p(c-n)  在编辑模式中, 输入几个字符后再输入此命令则vi 开始向上(下)搜索开头与其匹配的单词并补齐, 不断输入此命令则循环查找. 此命令会在所有在这个vim 程序中打开的文件中进行匹配.

>c-x-l   在编辑模式中, 此命令快速补齐整行内容, 但是仅在本窗口中出现的文档中进行匹配.

>c-x-f   在编辑模式中, 这个命令表示补齐文件名. 如输入: /usr/local/tom 后再输入此命令则它会自动匹配出: /usr/local/tomcat/

>abbr   即缩写. 这是一个宏操作, 可以在编辑模式中用一个缩写代替另一个字符串. 比如:abbr sprt System.out.println，以后在输入sprt后再输入其他非字母符号, 它就会自动扩展为System.out.println



