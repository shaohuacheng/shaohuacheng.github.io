---
layout: post
title: vim的一些技巧
date: 2017-11-12
description: “vim的一些技巧，提升工作效率”
tag: technology
---   


之前使用vim只会用简单的操作，遇到某些需求还是需要很麻烦的操作。
后来发现需要的功能其实vim都有，只是某些技巧还没掌握。
Vim功能实在太强大，在此对vim功能做个简单汇总，以便日后查阅。
命令是死的，人是活的。巧妙使用可以带来amazing的效果。


* [查找命令](#1)

* [移动光标命令](#2)

* [拷贝/删除/粘贴命令](#3)

* [编辑命令](#4)

* [替换命令](#5)

* [标签页命令](#6)

* [缩进](#7)

* [补全补齐](#8)

* [其他](#9)


****


<h2 id="1"> 查找命令 </h2>


>**\*/#/gd**: 这两个可以查找完全匹配当前单词的字符串，*是往后找，#是往前找，gd会跳到文档第一个匹配处。

>**g\*/g#**: 这两个命令可以查找包含当前单词的字符串，比如在单词is上，可以找到aisb，只使用*/#则不行

>**%**: 跳到匹配的括号处(){}[]

>**fx/Fx**: 跳到当前行前一个/后一个字符x处，x可以是任意字符。找到后输入”;”继续找，输入”,”反方向找。本身是查找命令，但用来移动光标非常方便

或者在#命令模式#下使用

>**/str1**:	向后查找

>**?str1**:	向前查找


str1指代任何正则表达式


****


<h2 id="2"> 移动光标命令 </h2>


#### 移动光标

>**j/k/l/s**:   光标向上/下/左/右移动

>**w(e)/b**:   下一个单词(词尾)/下一个单词

>**0/^/$**:   行开头处/行开头第一个字符处/行末尾

>**H/M/L**:   移动光标到：屏幕的首行/中间一行/尾行，不难记，就是high/middle/low

>**gg/G**:    整个文档的首行/尾行

>**{**:	转到上一个空行

>**}**:	转到下一个空行

#### 移动屏幕

>**ctrl+f/ctrl+b**:   类似windows中的page down/page up, f和b怀疑是front和back

>**ctrl+u/ctrl+d**:   屏幕向后/前移动半页，相当于半个page up/page down，u和d分别对应up和down

>**ctrl+e/ctrl+y**:   编辑窗口中的文件内容整体上移/下移一行

>**zz/zt/zb**:   将当前行放置于页面中间/页面顶端/页面底部, 尤其是zt命令在阅读函数时简直神器


#### 标记和标签

在修改文档过程中vim会自动记录标记,user也可以给某些地方手动设置标签.

>**’’**:   连按两个单引号，可以回到光标刚才的标记处，比如gd到文档开头，可以用它回到刚才的地方

>**’.**:   回到刚才修改的那一行

>**`.**:    回到刚才修改的那个地方

>**ma**:	把当前位置存成标签a

>**`a**:	跳转到标签a处


- - - 


<h2 id="3"> 拷贝/删除/粘贴命令 </h2>


vim中y表示拷贝,d表示删除,p表示粘贴，后面跟内容表示具体的操作域(结合f/F命令非常方便)，前面加数字表示执行次数。
(操作域:w代表光标处到当前词尾，aw表示不管光标位置总是整个词)


>**yw/ye/y0/y^/y$/yy**:   拷贝从当前光标到单词结尾/单词结尾/行首／行首第一个字符/行尾/整行

>**yaw**: 拷贝光标所在的整个单词

>**dw/de/d0/d^/d$/dd**:   删除从当前光标到单词结尾/单词结尾/行首／行首第一个字符/行尾/整行

>**daw**: 删除光标所在整个单词

>**yfx/dfx 或(yFx/dFx)**:   拷贝/删除当前光标到后面(或前面)第一个字符x处，x可以为任意字符

>**y\*/y# 或(d\*/d#)**:   拷贝（或删除）当前光标到下一个/上一个光标所在单词处

>**D**:   删除到行尾,相当于d$

>**Y**:   拷贝整行,相当于yy

>**]p**:  有缩进的粘贴，粘贴时会自动缩进

数字、查找域、y/d命令可随意结合使用，如:

>**d3F_**:	表示删除至往前属第3个”_”符号处

****



<h2 id="4"> 编辑命令 </h2>


删除/拷贝/粘贴后vim依然停留在正常模式,如需快速进入编辑模式,不仅可以用a或i,还有很多更便捷的操作

>**a/i**:	进入编辑模式,a表示在光标后插入,i表示光标位置插入 

>**A**:   在本行行尾插入

>**J**:  可以去除本行和下一行之间的换行符，也就是将下一行续接到本行尾部，这个真是不要太有用

>**cc/cw/c$/c0/c^**:   删除整行/当前字/至行尾/至行首/至第一个字符，并进入编辑模式

>**c2fa**:	删除至光标后第2个字符a处,并进入编辑模式

>**C**:	删除至行尾并进入编辑模式,相当于c$

>**s**:   删除当前字符并进入编辑模式

>**S**:   删除光标所在行并进入编辑模式，同cc命令

>**x**:	删除当前字符


***

<h2 id="5"> 替换命令 </h2>

vi/vim 中可以在*命令模式*下使用s命令来替换字符串。方法为:

>**[a,b]s/str1/str2/[g]**

其中[a,b]代表作用的行数，其中a、b为具体数字代表行数，a和b为”.”代表当前行，为”$”代表最后一行。用%替[a,b]表示所有行。
g表示替换当前行的所有str1，不带g则仅替换当前行的第一个。

>**s/str1/str2/**:   替换当前行第一个str1为str2

>**s/str1/str2/g**:   替换当前行所有str1为str2

>**10,$s/str1/str2/**:   替换第10行到最后一行中每一行的第一个str1为str2

>**.,100s/str1/str2/g**:   替换当前行到第100行中每行的所有str1为str2

>**%s/str1/str2/**:   其中%表示替换所有行

>**%s/^/str1/**:   将所有行到开头处加入str1字符

>**s/str1/str2/gc**:   替换当前行所有str1为str2，替换的每次需要确认。c是confirm的缩写


可以使用 # 作为分隔符，此时中间出现的 / 不会作为分隔符 

>**s#str1/#str2/#**:   替换当前行第一个 str1/ 为 str2/，使用了#作为分隔符

>**s+/root/user1+/usr/user2+**:   替换 /root/user1 为/usr/user2，使用了+作为分隔符


除了用s命令开头，也可以用如下方式：

>**[a,b]g/str1/[command]**

grep满足正则式str1的所有行，执行对应操作。如：

>**g/str1/d**:   将所有包含str1的行删除

>**g/^$/d**:   将所有空行删除

后跟s命令时，将s命令的第一个参数置空,因为它会使用grep来的行。

>**g/str1/s//str2/**:   等同于 %s/str1/str2/ 替换每一行的第一个str1为str2

>**g/str1/s//str2/g**:   等同于 %s/str1/str2/g 替换每一行中所有str1为str2

>**%s/ *$//g**:   删除所有行尾空格


由于window下用 回车换行（\r\n）来表示换行，linux下是换行（\n）来表示。这样，将window上的文件拷到unix上用时，总会有个^M。
在unix下删除windows文件的^M符号,只需

>**%s/^M//**

即可。也可以使用shell的tr命令或sed命令:

>**cat filename \| tr -d “^M” > newfile**

>**sed -e “s/^M//” filename > new file**

其中^M符号的输入方式见本文末尾，**用先ctrl+v再ctrl+m输入**。


***

<h2 id="6"> 标签页命令 </h2>

>**:newtab filename**:   新vim标签页打开文件

打开后：

>**gt/gT**:  切换到下一个/上一个标签页

>**ctrl+ws**:   水平切分标签页，两个是同一个文件，有任何操作都是相同的

>**ctrl+wv**:  垂直切分标签页 

>**ctrl+ww**:   切换标签页

>**ctrl+wq**:   关闭当前标签页 

>**:sp filename**:   split标签页打开文件

>**:vsp filename**:   垂直split标签页打开文件

>**:e filename**:   把当前缓冲区文件存为文件filename


***

<h2 id="7"> 缩进 </h2>


>**\>\>**:   行向右移动一个tab

>**:12,24>**:   将12行到14行的数据都向右移动一个tab.

>**:12,24\>\>**:   将12行到14行的数据都向右移动两个tab.

>**==**:  自动缩进当前行

>**gg=G**:   自动缩进



***

<h2 id="8"> 补全补齐 </h2>


>**ctrl+p(ctrl+n)**:   在编辑模式中, 输入几个字符后再输入此命令则vi 开始向上(下)搜索开头与其匹配的单词并补齐, 不断输入此命令则循环查找. 此命令会在所有在这个vim 程序中打开的文件中进行匹配.

>**ctrl+x+l**:   在编辑模式中, 此命令快速补齐整行内容, 但是仅在本窗口中出现的文档中进行匹配.

>**ctrl+x+f**:   在编辑模式中, 这个命令表示补齐文件名. 如输入: /usr/local/tom 后再输入此命令则它会自动匹配出: /usr/local/tomcat/

>**abbr**:   即缩写. 这是一个宏操作, 可以在编辑模式中用一个缩写代替另一个字符串. 比如:abbr sprt System.out.println，以后在输入sprt后再输入其他非字母符号, 它就会自动扩展为System.out.println


***

<h2 id="9"> 其他 </h2>

>**ga**:   显示光标字符的编码值

>**ctrl+a/ctrl+x**:   可以将光标所在处的数字加1/减1(这个命令让人想笑)

>**guu/guw/gu$/gu0/gu^**:  当前行/到词尾/到行尾/到行首/到行首第一个字符转换为小写

>**gUU/gUw/gU$/gU0/gU^**:   当前行/到词尾/到行尾/到行首/到行首第一个字符转换为大写


**输入^M时，使用ctrl+v,ctrl+m即可。输入^A等也是同理, 前面先加ctrl+v即可。**



